import{C as h,q as w,af as F,ah as P,o as y,g as U,w as t,c5 as x,D as m,F as C,v as S,t as s,E as N,z as v}from"./index-BNebTW0K.js";import{v as q,_ as B}from"./PageContainer-CGIomV_Y.js";import{E as I,a as b}from"./el-form-item-B2xQJZXZ.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as L}from"./index-BONl60qr.js";import"./error-Do6ODTPJ.js";import"./_baseClone-BRj6C6Ed.js";const O={class:"password-form-container"},R={__name:"UserPassword",setup(T,{expose:g}){const u=h(),i=w(!1),l=w(),o=w({old_pwd:"",new_pwd:"",re_pwd:""}),E=F({old_pwd:[{required:!0,validator:(a,e,r)=>{e?e.length<6||e.length>15?r(new Error("密码长度必须在6-15位之间")):/\S/.test(e)?(o.value.new_pwd&&l.value.validateField("new_pwd"),r()):r(new Error("密码不能为空字符串")):r(new Error("请输入原密码"))},trigger:"blur"}],new_pwd:[{required:!0,validator:(a,e,r)=>{e?e.length<6||e.length>15?r(new Error("密码长度必须在6-15位之间")):/\S/.test(e)?e===o.value.old_pwd?r(new Error("新密码不能与原密码相同")):(o.value.re_pwd&&l.value.validateField("re_pwd"),r()):r(new Error("密码不能为空字符串")):r(new Error("请输入新密码"))},trigger:"blur"}],re_pwd:[{required:!0,validator:(a,e,r)=>{e?e.length<6||e.length>15?r(new Error("密码长度必须在6-15位之间")):/\S/.test(e)?e!==o.value.new_pwd?r(new Error("确认密码与新密码不一致")):r():r(new Error("密码不能为空字符串")):r(new Error("请输入确认密码"))},trigger:"blur"}]}),_=async()=>{if(l.value)try{await l.value.validate(),i.value=!0,await x(o.value),i.value=!1,m.success("密码修改成功！"),p(),u.setToken(""),u.setUser({}),C.push("/login")}catch(a){console.log("校验失败:",a),m.error("请检查表单内容")}},p=()=>{l.value&&l.value.resetFields()};return g({submitForm:_,resetForm:p,pwdForm:o}),(a,e)=>{const r=L,n=b,f=N,c=I,V=q;return P((y(),U(B,{title:"修改密码"},{default:t(()=>[S("div",O,[s(c,{ref_key:"formRef",ref:l,model:o.value,rules:E,"label-width":"100px",class:"password-form"},{default:t(()=>[s(n,{label:"原密码",prop:"old_pwd"},{default:t(()=>[s(r,{modelValue:o.value.old_pwd,"onUpdate:modelValue":e[0]||(e[0]=d=>o.value.old_pwd=d),type:"password",placeholder:"请输入原密码","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),s(n,{label:"新密码",prop:"new_pwd"},{default:t(()=>[s(r,{modelValue:o.value.new_pwd,"onUpdate:modelValue":e[1]||(e[1]=d=>o.value.new_pwd=d),type:"password",placeholder:"请输入新密码","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),s(n,{label:"确认密码",prop:"re_pwd"},{default:t(()=>[s(r,{modelValue:o.value.re_pwd,"onUpdate:modelValue":e[2]||(e[2]=d=>o.value.re_pwd=d),type:"password",placeholder:"请再次输入新密码","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),s(n,null,{default:t(()=>[s(f,{type:"primary",onClick:_},{default:t(()=>[...e[3]||(e[3]=[v(" 修改密码 ",-1)])]),_:1}),s(f,{onClick:p},{default:t(()=>[...e[4]||(e[4]=[v(" 重置 ",-1)])]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1})),[[V,i.value]])}}},W=D(R,[["__scopeId","data-v-d6b5445c"]]);export{W as default};
